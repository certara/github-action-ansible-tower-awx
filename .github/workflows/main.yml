name: 'Test Run Ansible Tower/AWX'

on: [push]

jobs:
  test_ansible_tower:
    runs-on: self-hosted
    steps:
      # To use this repository's private action,
      # you must check out the repository
      - name: Checkout
        uses: actions/checkout@v2
      - name: Find My IP
        run: wget -qO- https://ipecho.net/plain ; echo
      - name: Trial Run Ansible Tower
        id: ansible
        uses: ./
        with:
          ansible-tower-user: ${{ secrets.CERTARA_ANSIBLE_TOWER_USER }}
          ansible-tower-pass: ${{ secrets.CERTARA_ANSIBLE_TOWER_PASSWORD }}
          ansible-tower-url: 'http://ip-172-16-0-220.ec2.internal/'
          # ansible-tower-url: ${{ secrets.CERTARA_ANSIBLE_TOWER_URL }}
          template-id: '38'
          additional-vars: |
            {
                "aws_environment": "test"
            }
